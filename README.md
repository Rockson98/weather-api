# ğŸŒ¤ï¸ å¤©æ°”APIæœåŠ¡ - Difyé›†æˆç‰ˆ

ä¸€ä¸ªåŸºäºFlaskçš„å¤©æ°”æŸ¥è¯¢APIæœåŠ¡ï¼Œä¸“ä¸ºDifyå¹³å°è®¾è®¡ï¼Œæ”¯æŒå¤šæ”¯è·¯å·¥ä½œæµï¼Œå¯éƒ¨ç½²åˆ°Renderç­‰äº‘å¹³å°ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

- ğŸŒ¤ï¸ å®æ—¶å¤©æ°”æŸ¥è¯¢
- ğŸŒ æ”¯æŒå…¨çƒåŸå¸‚
- ğŸ‡¨ğŸ‡³ ä¸­æ–‡ç•Œé¢
- ğŸ”§ ä¸“ä¸ºDifyä¼˜åŒ–
- ğŸ“Š æ ‡å‡†åŒ–APIæ¥å£
- ğŸ›¡ï¸ å®Œå–„çš„é”™è¯¯å¤„ç†
- â˜ï¸ äº‘å¹³å°éƒ¨ç½²æ”¯æŒ
- ğŸ”„ å¤šæ”¯è·¯å·¥ä½œæµæ”¯æŒ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æœ¬åœ°å¼€å‘

1. **å…‹éš†ä»“åº“**
```bash
git clone https://github.com/your-username/weather-api.git
cd weather-api
```

2. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

3. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
# åˆ›å»º.envæ–‡ä»¶
echo "WEATHER_API_KEY=your_openweather_api_key_here" > .env
```

4. **å¯åŠ¨æœåŠ¡**
```bash
python main.py
```

æœåŠ¡å°†åœ¨ `http://localhost:8000` å¯åŠ¨ã€‚

### äº‘å¹³å°éƒ¨ç½²

#### Renderéƒ¨ç½²

1. **Forkæœ¬ä»“åº“åˆ°æ‚¨çš„GitHubè´¦æˆ·**

2. **åœ¨Renderä¸­åˆ›å»ºæ–°æœåŠ¡**
   - é€‰æ‹© "Web Service"
   - è¿æ¥æ‚¨çš„GitHubä»“åº“
   - é…ç½®ç¯å¢ƒå˜é‡

3. **ç¯å¢ƒå˜é‡é…ç½®**
```
WEATHER_API_KEY=your_openweather_api_key_here
```

4. **éƒ¨ç½²è®¾ç½®**
   - Build Command: `pip install -r requirements.txt`
   - Start Command: `python main.py`

## ğŸ”— Difyé›†æˆ

### æ–¹æ¡ˆAï¼šç®€å•é›†æˆï¼ˆæ¨èæ–°æ‰‹ï¼‰

1. **éƒ¨ç½²APIåˆ°Render**
2. **åœ¨Difyä¸­åˆ›å»ºè‡ªå®šä¹‰å·¥å…·**
   - å·¥å…·ç±»å‹: APIå·¥å…·
   - APIç«¯ç‚¹: `https://your-app-name.onrender.com/weather`
   - è¯·æ±‚æ–¹æ³•: GET
   - å‚æ•°: `city` (string, å¿…éœ€)

3. **åœ¨åº”ç”¨ä¸­ä½¿ç”¨å·¥å…·**

### æ–¹æ¡ˆBï¼šå¤šæ”¯è·¯å·¥ä½œæµï¼ˆæ¨èé«˜çº§ç”¨æˆ·ï¼‰

ä½¿ç”¨æˆ‘ä»¬æä¾›çš„å¤šæ”¯è·¯å·¥ä½œæµæ–¹æ¡ˆï¼Œæ”¯æŒï¼š
- å¤©æ°”æ’­æŠ¥ç”Ÿæˆ
- æ•£æ–‡åˆ›ä½œ
- å›¾ç‰‡ç”Ÿæˆ
- æ•°æ®åˆå¹¶

è¯¦ç»†é…ç½®è¯·å‚è€ƒï¼š
- [Difyå¤šæ”¯è·¯å·¥ä½œæµé…ç½®æŒ‡å—](dify_solution_b_setup_guide.md)
- [LLMèŠ‚ç‚¹é…ç½®æŒ‡å—](dify_solution_b_llm_config_guide.md)

## ğŸ“š APIæ–‡æ¡£

### è·å–å¤©æ°”ä¿¡æ¯

**è¯·æ±‚**:
```
GET /weather?city=åŒ—äº¬
```

**å“åº”**:
```json
{
  "city": "åŒ—äº¬",
  "temperature": 15.5,
  "description": "å¤šäº‘",
  "humidity": 65,
  "wind_speed": 3.2,
  "pressure": 1013,
  "visibility": 10000,
  "feels_like": 14.8
}
```

### APIç«¯ç‚¹

- `GET /` - æœåŠ¡çŠ¶æ€
- `GET /weather` - å¤©æ°”æŸ¥è¯¢
- `GET /openapi.json` - OpenAPIæ–‡æ¡£

## ğŸ› ï¸ é¡¹ç›®ç»“æ„

```
weather-api/
â”œâ”€â”€ main.py                                    # ä¸»åº”ç”¨å…¥å£
â”œâ”€â”€ tianqi_webtool/                           # å¤©æ°”å·¥å…·åŒ…
â”‚   â”œâ”€â”€ server.py                            # FlaskæœåŠ¡å™¨
â”‚   â”œâ”€â”€ client.py                            # å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ config.py                            # é…ç½®
â”‚   â”œâ”€â”€ schemas.py                           # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ openweather_client.py                # OpenWeatherå®¢æˆ·ç«¯
â”œâ”€â”€ dify_tool/                               # Difyå·¥å…·æ–‡ä»¶
â”‚   â”œâ”€â”€ manifest.json                        # å·¥å…·æ¸…å•
â”‚   â”œâ”€â”€ openapi.json                         # APIæ–‡æ¡£
â”‚   â””â”€â”€ weather_tool.py                      # å·¥å…·å®ç°
â”œâ”€â”€ dify_solution_b_*.py                     # Difyå¤šæ”¯è·¯å·¥ä½œæµæ–¹æ¡ˆ
â”œâ”€â”€ requirements.txt                         # Pythonä¾èµ–
â”œâ”€â”€ render.yaml                             # Renderéƒ¨ç½²é…ç½®
â””â”€â”€ README.md                               # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ ç¯å¢ƒå˜é‡

| å˜é‡å | æè¿° | é»˜è®¤å€¼ |
|--------|------|--------|
| `WEATHER_API_KEY` | OpenWeatherMap APIå¯†é’¥ | å¿…éœ€ |
| `PORT` | æœåŠ¡ç«¯å£ | 8000 |
| `HOST` | æœåŠ¡ä¸»æœº | 0.0.0.0 |

## ğŸ§ª æµ‹è¯•

### æœ¬åœ°æµ‹è¯•

```bash
# æµ‹è¯•æœåŠ¡çŠ¶æ€
curl http://localhost:8000/

# æµ‹è¯•å¤©æ°”æŸ¥è¯¢
curl "http://localhost:8000/weather?city=åŒ—äº¬"
```

### ç”Ÿäº§ç¯å¢ƒæµ‹è¯•

```bash
# æ›¿æ¢ä¸ºæ‚¨çš„Render URL
curl https://your-app-name.onrender.com/weather?city=åŒ—äº¬
```

## ğŸ“– è¯¦ç»†æ–‡æ¡£

- [Difyé›†æˆå®Œæ•´æŒ‡å—](DIFY_INTEGRATION_GUIDE.md)
- [å¤šæ”¯è·¯å·¥ä½œæµé…ç½®](dify_solution_b_setup_guide.md)
- [LLMèŠ‚ç‚¹é…ç½®æŒ‡å—](dify_solution_b_llm_config_guide.md)

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### ç®€å•æŸ¥è¯¢
ç”¨æˆ·è¯¢é—®ï¼š"åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"

Difyåº”ç”¨ä¼šï¼š
1. è°ƒç”¨å¤©æ°”æŸ¥è¯¢å·¥å…·
2. ä¼ å…¥å‚æ•°ï¼š`city=åŒ—äº¬`
3. è·å–å¤©æ°”æ•°æ®
4. è¿”å›å‹å¥½æ ¼å¼çš„å¤©æ°”ä¿¡æ¯

### å¤šæ”¯è·¯å·¥ä½œæµ
ç”¨æˆ·è¯¢é—®ï¼š"ç»™æˆ‘å†™ä¸€ç¯‡å…³äºåŒ—äº¬å¤©æ°”çš„æ•£æ–‡"

Difyåº”ç”¨ä¼šï¼š
1. è·å–å¤©æ°”æ•°æ®
2. ç”Ÿæˆå¤©æ°”æ’­æŠ¥
3. åˆ›ä½œå¤©æ°”æ•£æ–‡
4. åˆå¹¶è¾“å‡ºç»“æœ

## â“ å¸¸è§é—®é¢˜

**Q: APIè¿”å›500é”™è¯¯ï¼Ÿ**
A: æ£€æŸ¥OpenWeatherMap APIå¯†é’¥æ˜¯å¦æ­£ç¡®è®¾ç½®

**Q: Difyæ— æ³•è¿æ¥å·¥å…·ï¼Ÿ**
A: ç¡®è®¤APIæœåŠ¡å·²éƒ¨ç½²ä¸”openapi.jsonå¯è®¿é—®

**Q: å¤©æ°”æ•°æ®ä¸å‡†ç¡®ï¼Ÿ**
A: ç¡®è®¤åŸå¸‚åç§°æ‹¼å†™æ­£ç¡®ï¼Œæ£€æŸ¥APIå“åº”

**Q: å¤šæ”¯è·¯å·¥ä½œæµä¸å·¥ä½œï¼Ÿ**
A: æ£€æŸ¥ä»£ç æ‰§è¡ŒèŠ‚ç‚¹çš„å‚æ•°é…ç½®å’Œè¾“å‡ºå˜é‡

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·åˆ›å»ºIssueæˆ–è”ç³»ç»´æŠ¤è€…ã€‚